<layout name="Public/public" />

<!--<link href="__PUBLIC__/css/index.css" rel="stylesheet">-->
<!--图标样式-->
<!--<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/bootstrap.min.css">-->
<!--主要样式-->
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/styleone.css">
<!--<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/my/show.css">--> 
<!--<script type="text/javascript" src='__PUBLIC__/js/jquery.js'></script>-->
<script type="text/javascript" src="__PUBLIC__/Admin/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
    $(function(){
    $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Collapse this branch');
    $('.tree li.parent_li').on('click',"span" , function (e) {
        var children = $(this).parent('li.parent_li').find(' > ul > li');
        if (children.is(":visible")) {
            children.hide('fast');
            $(this).attr('title', 'Expand this branch').find(' > i').addClass('glyphicon-plus').removeClass('glyphicon-minus');
        }else{
            var mid = $(this).children('input').val();
            var tet = $(this).next('a').next('b').next('ul').html();
            //判断有没有把下属显示出来
            if(tet == ""){
              var texta = '';
              $.ajax({
                  async: false,
                  type : "POST",
                  data: {mid:mid},
                  dataType: "json",
                  url : '__URL__/treedirect_recommend',
                  success : function(data) {
                    if(data == 1){
                      alert("没推荐人经销商！");
                      return;
                    }
                    //alert(data);
                    for(var i=0;i<data.length;i++){
                      texta += '<li class="parent_li"><span title="Expand this branch" class="level'+data[i]['level']
                              +'"><input type="hidden" value="'+data[i]['id']+'"><i class="glyphicon glyphicon-plus"></i>'
                              +data[i]['name']+'</span> <a href="javascript:void(0);" onclick="change_iframe_src('+data[i]['id']
                              +')">详情</a><b>'+data[i]['count']+'</b><ul></ul></li>';
                    }
                  }
              });
              $(this).next('a').next('b').next('ul').html(texta);
            }
            children.show('fast');
            $(this).attr('title', 'Collapse this branch').find(' > i').addClass('glyphicon-minus').removeClass('glyphicon-plus');
        }
        e.stopPropagation();
    });
});
</script>
<style>
    /*  .bg{background:url(__PUBLIC__/images/shouquan.jpg);background-size:450px 672px;width:450px;height:672px;margin:0 auto;position:absolute;right:130px;top:45px;}
      .bg h1{font-size:35px;color:#4abcf2;padding-top:193px;margin-left:54px;}
      .bg .test{margin-top:52px;margin-left:55px;min-width:200px;max-width: 325px;}
      .bg p{font-size:18px;line-height:29px;margin: 0 0 0px; }
      .bg hr{margin: 0px 0;}
      #bg{
          -webkit-transform: rotate(45deg);  
          -moz-transform: rotate(45deg);  
          filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
          overflow: hidden;
          z-index: 9999;
          opacity: 0.1;
          font-size: 30px;
          }*/
    .level{
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        border: 1px solid #999;
        display: inline-block;
        padding: 3px 8px;
        text-decoration: none;
    }
    b{
        color:red;
        margin-left:10px;
        font-size:16px;
    }
    .level2{
        background-color: #041c42;
        color: #fff;
    }
    .level3{
        background-color: #7b1182;
        color: #fff;
    }
    .level4{
        background-color: #bac415;
        color: #fff;
    }
    .level5{
        background-color: #15bac4;
        color: #fff;
    }
    .level6{
        background-color: #20d9b0;
        color: #fff;
    }
    .level7{
        background-color: #ADD8E6;
        color: #fff;
    }
    .level8{
        background-color: #FFA500;
        color: #fff;
    }
    .level9{
        background-color: #C0C0C0;
        color: #fff;
    }
    .level10{
        background-color: #A52A2A;
        color: #fff;
    }
    /* .parent_li a{position: absolute;left: 30px;} */

    .iframe_div{
        width:640px;
        height: 1000px;
        /*zoom:100%;*/
    }
</style>


<h1 class="page-header">
    推荐人树状图
</h1>


<div class="container tree">
    <div class="row">
        <div class="col-md-8">
            <egt name="level_num" value="1"><span class="level">{$level_name.1}</span></egt>
            <egt name="level_num" value="2"><span class="level level2">{$level_name.2}</span></egt>
            <egt name="level_num" value="3"><span class="level level3">{$level_name.3}</span></egt>
            <egt name="level_num" value="4"><span class="level level4">{$level_name.4}</span></egt>
            <egt name="level_num" value="5"><span class="level level5">{$level_name.5}</span></egt>
            <egt name="level_num" value="6"><span class="level level6">{$level_name.6}</span></egt>
            <egt name="level_num" value="7"><span class="level level7">{$level_name.7}</span></egt>
            <egt name="level_num" value="8"><span class="level level8">{$level_name.8}</span></egt>
            <egt name="level_num" value="9"><span class="level level9">{$level_name.9}</span></egt>
            <egt name="level_num" value="10"><span class="level level10">{$level_name.10}</span></egt>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-4">
            <ul>
                <volist name="row" id="vo">
                    <li class="parent_li">
                        <span class="level{$vo.level}" title="Expand this branch"><input type="hidden" value="{$vo.id}">
                            <i class="glyphicon glyphicon-plus"></i>{$vo.name}</span>
                        <a href="javascript:void(0);" onclick="change_iframe_src('{$vo.id}')">详情</a>
                        <b>{$vo.count}</b>
                        <ul></ul>
                    </li>
                </volist>
            </ul>
        </div>
        <div class="col-md-4">
            <div class="embed-responsive embed-responsive-16by9 iframe_div">
                <iframe class='embed-responsive-item' id='iframe_src' src=""></iframe>
            </div>
        </div>
    </div>
</div>

<script>
    
    function change_iframe_src(id){
        var src = 'http://{$YM_DOMAIN}/manager/detail?no_header=1&id='+id;
        
        $("#iframe_src").attr('src',src);
    }
    
</script>