<!DOCTYPE html>
<html lang="en">

  <head>
    <style>
       @media screen and (max-width: 768px) {
            .modal-dialog {
                margin: 80px 5% 0 5%;
            }
       } 
    </style>
    <script type="text/javascript" src="__PUBLIC__/js/WdatePicker.js"></script>
  </head>

  <body>
    <section class="layui-container">
      <div class="content">
        <header class="header">
          <h3>充值记录</h3>
          <a href="__URL__/expUser?pd=money_recharge_log" class="layui-btn layui-btn-radius layui-btn-normal">导出Excel</a>
        </header>
        <form class="layui-form form layui-row form-search" action="__SELF__" method="get" onsubmit="return false">
          <div class="layui-form-item form-item">
            <label class="layui-form-label">开始时间</label>
            <div class="time-wrapper">
              <input type="text" class="layui-input blue" name="start_time" id="start_time" readonly="readonly" placeholder="开始时间" autocomplete="on">
              <i class="fa fa-angle-down"></i>
            </div>
          </div>
          <div class="layui-form-item form-item">
            <label class="layui-form-label">结束时间</label>
            <div class="time-wrapper">
              <input type="text" class="layui-input blue"  name="end_time" id="end_time" readonly="readonly" placeholder="结束时间" autocomplete="on">
              <i class="fa fa-angle-down"></i>
            </div>
          </div>
          <div class="layui-form-item form-item">
            <label class="layui-form-label">代理</label>
            <div>
              <input type="text" class="layui-input" name="name" id="name" placeholder="姓名/微信号/手机号" autocomplete="on">
            </div>
          </div>
          <label class="sr-only" for="type">充值类型</label>
          <!--<select name="type" id="type"  class="form-control">-->
          <!--<option value="">选择充值类型</option>-->
          <!--<option value="1">申请充值</option>-->
          <!--<option value="2">后台充值</option>-->
          <!--<option value="3">订单返现</option>-->
          <!--<option value="4">下级下单</option>-->
          <!--</select>-->
          <div class="search-btn">
            <button type="submit" class="layui-btn layui-btn-radius">搜索</button>
          </div>
        </form>
        <div class="table-wrapper">
          <table class="layui-table" lay-skin="row" lay-size="sm">
            <thead>
              <tr>
                <th>序号</th>
                <th>经销商名字</th>
                <th>微信号</th>
                <th>手机号</th>
                <th>等级</th>
                <th>虚拟币来源</th>
                <!--<th>充值申请ID</th>-->
                <th>充值金额</th>
                <th>充值类型</th>
                <th>备注</th>
                <th>记录时间</th>
              </tr>
            </thead>
            <tbody>
              <empty name="list">
                <tr style="position: relative;">
                    <td style="position: absolute;width: 97%;border-top: solid 1px #e6e6e6;">对不起,没有找到数据!</td>
                </tr>
                <else />
                <volist name="list" id="m">
                  <tr>
                    <td>{$m.id}</td>
                    <td>{$m.dis_name}</td>
                    <td>{$m.dis_wechatnum}</td>
                    <td>{$m.dis_phone}</td>
                    <td>{$m.dis_levname}</td>
                    <td>{$m.source_name}</td>
                    <!--<td>{$m.apply_id}</td>-->
                    <td>{$m.money}</td>
                    <td>
                      {$m.type_name}
                    </td>
                    <td>
                      <if condition="$m.type eq 1">
                        <button type="button" class="layui-btn layui-btn-radius layui-btn-warm" onclick="return get_apply_info('{$m.apply_id}');" data-toggle="modal" data-target=".apply">申请充值信息</button>
                        <elseif condition="$m.type eq 2" />

                        <elseif condition="$m.type eq 3" /> 订单号：{$m.note}
                        <elseif condition="$m.type eq 4" /> 订单号：{$m.note}
                      </if>
                    </td>
                    <td>{$m.created_format}</td>
                  </tr>
                </volist>
                <!-- <div id="page"></div> -->
                <!--<tr><td colspan="14"><div class="pull-right">{$page}</div></td></tr>-->
                <include file="Public/page" />
              </empty>
            </tbody>
          </table>
          <div class="modal fade bs-example-modal-sm apply" id="dialog" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-sm">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                  <h4 class="modal-title" id="myModalLabel">申请充值信息</h4>
                </div>
                <div class="modal-body">
                  <table class="table table-bordered">
                    <tr>
                      <td>申请ID</td>
                      <td id="apply_id"></td>
                    </tr>
                    <tr>
                      <td>经销商名字</td>
                      <td id="apply_name"></td>
                    </tr>
                    <tr>
                      <td>审核人</td>
                      <td id="apply_audit_name"></td>
                    </tr>
                    <tr>
                      <td>申请金额</td>
                      <td id="apply_money"></td>
                    </tr>
                    <tr>
                      <td>申请时间</td>
                      <td id="apply_created"></td>
                    </tr>
                  </table>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

    </section>
    <script>
      function get_apply_info(apply_id) {

        if(apply_id == null || apply_id == 0) {
          return false;
        }

        $.ajax({
          async: false,
          type: "POST",
          data: {
            id: apply_id
          },
          dataType: "json",
          url: '__URL__/get_apply_info',
          success: function(res) {
            if(res == null) {
              leyer.msg('获取错误！');
            } else if(res.code != 1) {
                leyer.msg(res.msg);
            } else {
              //                    $("#apply_name").html(res.info.money);
              $("#apply_id").html(res.info.id);
              $("#apply_name").html(res.info.dis_info.name);
              $("#apply_audit_name").html(res.info.audit_info.name);
              $("#apply_money").html(res.info.apply_money);
              $("#apply_created").html(res.info.created_format);

              return true;
            }
          }
        });

        return false;
      }

      function get_order_info(order_num) {

      }

      layui.use('laydate', function() {
        var laydate = layui.laydate;
        laydate.render({
          elem: '#start_time'
        });
        laydate.render({
          elem: '#end_time'
        });
      })
    </script>
  </body>

</html>