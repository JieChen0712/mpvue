<style type="text/css">
    .layui-layer-content {
        overflow: visible!important;
    }
    /*小屏幕样式*/

    @media screen and (max-width: 768px) {
        .modal-body .reset {
            margin-left: 0 !important;
        }
        .modal-body .reset .layui-btn-small {
            margin: 5px 0 0 15px;
        }
        .modal-body .layui-form .layui-form-label {
            width: 50px;
        }
        .modal-body .layui-form .layui-input-block {
            float: left;
            margin-left: 15px;
        }
        .special-item {
            padding: 15px;
        }
        .special-item .layui-input-block {
            margin-left: 15px;
        }
        .special-item .special-flex {
            margin-left: 15px;
        }
    }
</style>
<script>
    /**
     * 使用图片上传接口需满足以下条件
     * 1.容器选择器id=upload
     * 2.设置name=image的input标签隐藏域
     * 3.指定上传目录名称
     */
    //上传目录
    var upload_dir_name = 'store';
</script>
<div class="modal-body">
    <div style='margin-left: 29px;margin-top: 15px;' class="reset">
    </div>
    <form class="layui-form layui-box" action="__URL__/edit_post" data-auto="false" method="post">
        
        <?php if( empty($list) ):?>
        <div class="layui-form-item">
            <label class="layui-form-label" for="store_id">商城</label>
            <div class="input-wrapper">
                <select name="store_id" id="store_id" lay-verify="required">
                    <option value="">选择商城</option>
                    <?php foreach( $store_info as $v_store ):?>
                    <option value="{$v_store.id}">{$v_store.name}</option>
                    <?php endforeach;?>
                </select>
            </div>
        </div>
        <?php endif;?>
        
        <div class="layui-form-item">
            <label class="layui-form-label">首页轮播图：</label>
            <div class="layui-input-block">
                <!--引入图片页面-->
                <script src="__PUBLIC__/Radmin_v3/js/img_upload.js"></script>
                <if condition="$list.image neq ''">
                    <include file="Public/images" data-name="img[]" row_image="{$list.img}" />
                    <else/>
                    <include file="Public/images" data-name="img[]" row_image="{$list.img}" />
                </if>
            </div>
        </div>
        
            <div class="hr-line-dashed"></div>

            <div class="layui-form-item text-center">
                <input type="hidden" name="id" value="{$list.id}" />
                <button class="layui-btn" type='submit'>确认修改</button>
                <button class="layui-btn layui-btn-danger" type='button' data-confirm="确定要取消修改吗？" data-close>取消修改</button>
            </div>
    </form>
</div>

<script type="text/javascript">
    var province,province1,city,city1,area,area1;

    $.getJSON("__PUBLIC__/Radmin_v3/plugs/echart/map/area.json",function(data){
        province = new Array();
        $.each(data,function(key,value){
            province.push('<option value="'+value.name+'">'+value.name+'</option>');
        })
        $('#province').append(province);
        form.render('select');
    })

    form.on('select(province)',function(data){
        province1 = data.value;
        $.getJSON("__PUBLIC__/Radmin_v3/plugs/echart/map/area.json",function(data){
            city = new Array();
            $.each(data, function(key,value) {
                if(province1 === value.name){
                    $.each(value.sub, function(k,v) {
                        city.push('<option value="'+v.name+'">'+v.name+'</option>');
                    });
                }
            });
            $('#city').empty().append(city);
            form.render('select');
        });
    })

    form.on('select(city)',function(data){
        city1 = data.value;
        $.getJSON("__PUBLIC__/Radmin_v3/plugs/echart/map/area.json",function(data){
            area = new Array();
            $.each(data, function(key,value) {
                if(province1 == value.name){
                    $.each(value.sub, function(k,v) {
                        if(city1 == v.name){
                            if(!(v.sub==undefined||v.sub==""||v.sub==null)){
                                $.each(v.sub, function(i,j) {
                                    area.push('<option value="'+j.name+'">'+j.name+'</option>');
                                });
                            }
                        }
                    });
                }
            });
            $('#area').empty().append(area);
            form.render('select');
        });
    })
    form.render();
</script>
